# UnityInventory

개인과제 인벤토리 구현하기 입니다.  

구현 목표  
최대한 발제 요구 내용과 똑같이 구현해 보았습니다. 그외에 구조적으로 변화를 주고 고쳐 보려고 시도 했지만 실패해서 현재 까지는 수정 사항이 없습니다.
  

- Step1 UI 구성하기  
에셋을 제외한 구성을 스크린 샷과 최대한 똑같이 구현 했습니다.  
요구 하신 대로 캔버스로 구분하여 메인UI 인벤토리 UI 스테이터스UI로 구분해 구현하였습니다.  

특이사항으로는 이전 UI강의를 듣던중 레거시Text를 활용 한다면 Text를 개별로 생성하는게 아니라 한번에 생성 한다 들었던 기억이 있어서  
이번 과제에서 Text를 글자를 적는 용도로만 사용 하는 것 같아 레거시 Text를 사용해 보았습니다.  

  
- Step2 스크립트 만들기  
요구 한 스크립트를 만들어 두었습니다.  
UI는 하부에 구성요소를 필드로 만들어 두었습니다.  
[SerializedField] 를 활용하여 3개의 UI를 전부 연결해 주었습니다.  
캐릭터를 C#클래스로 만들어 생성자를 황용해 만들어 주었습니다.  
C# 주차 이후로 생성자를 써볼 일이 거의 없어서 활용이 조금 어려웠습니다.  
오브젝트/컴포넌트로 존재 하는게 아니라서 더 어려웠던 것 같습니다.  

  
- Step3 UI간 전환 기능 만들기  
UIManager를 통해 각 UI에 접근하고, 버튼 클릭 시 각 UI 열기/뒤로가기 기능 추가  
UI매니저 싱글톤으로 만들기 및 각 UI 프로퍼티(속성)로 제작 했습니다.  
UI매니저를 통해 각 UI 접근해서 켜기  
UI 접근해서 킨다는 것이 SetActive true/false 관리를 매니저에서 한다는 것인지  
각 UI에서 매니저를 통해 다른 UI를 가져와 각 UI 에서 껐다 켰다 반복 해주는 것인지 이해를 잘 하지 못하였습니다.  
우선은 전자가 더 객체지향 적인것 같아 UI매니저의 메서드를 UI들이 가져다 쓰는 형식으로 제작하였습니다.  

  
- Step4 캐릭터 정보 세팅하기  
메인메뉴/스테이터스의 UI와 정보를 연결해주었습니다.  
그 과정에서 요구하신대로 프로퍼티(속성)를 활용하였습니다.  
UI메인메뉴의 SetGold에서는 포맷을 UI스테이터스에서는 보간문자열을 사용하여 만들었습니다.  
GameManager내에 Player 프로퍼티를 생성자를 통해 데이터를 넣어주었습니다.  

  
- Step5 UISlot 동적 생성하기  
에셋을 제외하고 스크린샷과 최대한 똑같이 구현해보았습니다.  
스크롤 뷰를 통해 생성 된 슬롯이 현재 칸을 넘어 갔을 경우 스크롤이 가능하도록 구현했습니다.  
확인 하실 경우 Prefab에 있는 슬롯을 여러개 생성 하신 후 확인해주시면 될 것 같습니다.  
요구 하신 대로 UI인벤토리 내에 Slot프리팹을 캐싱 및 List를 통해 관리 하고 있습니다.  

  
- Step6 Item 데이터 준비하기  
ItemData 스크립트를 작성했습니다.  
생성자 및 프로퍼티를 구현했습니다.  
캐릭터 스크립트를 통해 아이템 사용 시 캐릭터/UI 의 적용하도록 구현 하였습니다.  
GameManager SetData매서드에 생성자를 통해 아이템 데이터를 추가해 주었습니다.  

  
- Step7 아이템 장착  
step5에서 구현해 두었던 아이템 장착/해제 표시를 응용해 장착/해제를 표시해주었습니다.  

  
- Step8 Status에 아이템 정보 반영  
전 과정에서 정보 반영을 미리 해주어 정보 반영이 잘 되었습니다.  

  
- 트러블 슈팅 및 모르던 지식들  
  
UI 스크롤 뷰  
컨턴트 아래에 자식 UI를 넣어야 하는데 뷰포트 아래다 넣어버렸습니다.  
컨턴트에 넣어서 스크롤은 되지만 컨턴트가 짧아서 스크롤을 할 수가 없었습니다
컨턴트 사이즈 필터를 사용해 보았습니다  
정상 작동 하지만 사용 법 따로 더 공부할 필요가 있어 보입니다.  
  
생성자를 오브젝트화 하려 했습니다.  
new를 통한 생성과 컴포넌트를 달아주는 것의 차이를 잘 인지 하지 못했습니다.  
new를 통해 생성을 했습니다.  
유니티에서의 생성자 사용법 공부 및 생성자 복습이 필요해 보입니다.  
  
AddListener   
버튼에 .AddListener를 사용 했더니 접근 할 수가 없었습니다.  
버튼에 .Onclick이라는 이벤트에 접근해 AddListener를 통해 이벤트 등록을 해야 했습니다.
그냥 AddListener를 사용 하면 안되었습니다. 어떤 이벤트에 등록 할 것인지를 정해주는 과정이 필요하다는 것을 알았습니다.  
  
생명주기 문제  
Start에서 구독을 하고 > OnDisable구독 해제해 주었습니다.  
실행 할 때 마다 SetActive를 껐다 켜주는 함수 인데 false가 되는 순간  Ondisable 실행 > 끝  
Start는 처음 생성 될 때 단 한번만 실행 된다고 했었던게 기억났습니다. Active가 켜졌다 꺼졌다 하더라도 단 한번만 실행하는 함수입니다.  
수정 방법은 두가지가 있었습니다  
1 OnEnable은 계속 실행이 되기 때문에 보통 OnEnable에 등록합니다.  
2. Start에서 구독 후 OnDestroy에서 해제 해주기   
> 스타트는 한번 실행되기 때문에 계속 사용 할거라면 절대 먼저 구독을 취소하면 안됩니다.  
> 스타트에서 이벤트를 등록하라는 요구가 있었기에 OnDestroy를 통해 구독을 해제해 주었습니다.  
  
천원 단위로 , 찍어주기 예) 20000 > 20,000  
"N" 포맷은 기본적으로 "천 단위 구분 기호(콤마)"를 넣어주는 기능이라고 합니다.  
"N" = 숫자를 지역화된(로케일에 맞는) 숫자 형식으로 바꿔줍니다.  
한국/미국 로케일 → , 를 3자리마다 찍습니다.  
"N0" → 소수점 0자리, 즉 소수점은 안 나오고 콤마만 유지  
"N2" → 소수점 2자리까지 표시 + 콤마  
예전에 쓰던 N0은 float 에서 몇 번째 소수점 까지 볼것인지를 관리해주는줄 알았는데 콤마도 찍어준다는 것을 알게 되었습니다.  
  
for문 에서 캐싱 사용법  
테스트 과정에서 필요 했었기에 현재는 관련이 없습니다.  
  
for문의 조건식값이 계속 더해지거나 변할 경우 캐싱을 응용 할 수 있었습니다.   
위에 로직은 아이템 하나 먹었을 때 슬롯이 모자라다면 생성해 주는 로직인데 작성중 무한 생성되는 문제가 생겼었습니다. 안에서 Add를 해주기 땜에 조건문의 값이 계속 증가했습니다.  
그래서 값을 아예 고정 시켜주고 함수를 실행 할 때 한번만 값을 계산 후 초기화 해주었습니다.  
잘 작동 했습니다.  
캐싱을 이용 하는 방법도 잘 고려해봐야 할 것 같습니다.   
내부에서 캐싱을 하는게 아닌 전역필드로 작성 하는게 더 효율이 좋을 것 같습니다.  
  
  
- 개인적으로 튜터님께 질문하고 싶은 내용  
구조적인 부분이나 객체지향 자체에 지식이 많이 부족하다는 것을 알지만 아직 방향성을 잘 잡지 못하겠습니다. 분명 배웠던 방식들이 있고 가이드를 따라 할 때는 잘 적용을 할 수 있는데  
이번 과제 혹은 팀프로젝트를 하게 될 경우 스파게티 코드라고 하나요? 그런 식으로 작성 되는 경우가 많은 것 같습니다.  
공부의 방향성도 궁금하고 하드코딩을 하게 되는 원인이 무엇인지 아직도 저는 잘 모르겠어서 혹시 튜터님 께서 알고 계신다면 어떤 점을 개선해 나가야 할지 말씀 해주시면 감사하겠습니다.  
어떠한 방식으로 구조를 더 발전 시키고 리팩토링을 진행 할 때 어떤 점들을 위주로 진행을 해야하는지도 알고 싶습니다.  
  
현재 저의 단점과 개선 방향을 더 많이 알고 싶습니다. 어떤점이 부족하고 어떤 부분을 공부하는게 좋을지 자세하게 말씀해주시면 감사하겠습니다.  
개인 과제 봐주셔서 감사합니다.  
